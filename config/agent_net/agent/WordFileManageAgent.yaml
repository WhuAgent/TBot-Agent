# 对外暴露的 id，用于将 agent 引入 group
ref_id: "WordFileManageAgent"

# agent 的名称
name: "WordFileManageAgent"
# 对 agent 的详细描述
description: "负责对 word 的文件进行管理，打开关闭文档，保存文档，将文档输出为 PDF 等"
# agent 角色扮演相关？
role: ""
# agent 要执行的任务
task: ""
# agent 加载模式
load_type: "module"
# agent 类的位置
loadModule: "tbot.agent"
loadClass: "WordFileManageAgent"

# agent 是否需要与大模型进行交互
need_chat: True
model: "gpt-3.5-turbo"

init_extra_params:

# 执行上下文参数
params:
  - name: "code"
    type: "list"
  - name: "variables"
    type: "list"
  - name: "completed_tasks"
    type: "list"
  - name: "next_task"
    type: "str"

# 执行上下文结果
results:
  - name: "code"
    type: "list"
  - name: "variables"
    type: "list"
  - name: "completed_tasks"
    type: "list"
  - name: "next_agent"
    type: "str"
  - name: "error"
    type: "str"

services:
  - WordOpenDocument
  - WordSave
  - WordCloseDocument

# agent 的 prompt
prompts:
  - type: "inline"
    role: "system"
    content: |
      ### 角色 ###
       你是一位专业的文档处理专家，拥有丰富的 Word 文档操作经验和良好的沟通能力，能够与同组的其他 Agent 合作完成任务。
      
      ### 技能 ###
      你具备调用服务操作 Word 文档的能力，可调用的服务如下，以代码形式给出：
      
      {services}
          
      ### 目标 ###
      你需要理解用户需求和任务目标，并根据目前的操作环境状态，调用若干个服务，推进任务的进行。
      
      ### 工作流 ###
      你需要按照如下步骤进行工作：
      
      1. 理解用户要求和任务目标。
      2. 根据当前的操作环境状态，决定需要调用的服务。
      3. 调用该服务推进任务流程。
      4. 反馈信息。
      
      ### 返回方式 ###
      以 yaml 格式返回，使用 ### 开始，以 ### 结束，中间为 yaml 内容。内容为一个列表，列表的每一项包括三个部分：
      
      ###      
      - name: 要调用的服务的名称
        args: # 要调用的服务的参数
          arg_name: arg_value
        rets: # 服务返回值的配置，是一个列表，每一项包括三个部分，如果无返回值请返回空列表
          - name: 文档中对应的返回值名称,word_object 或者 read_object
            var: 生成的代码中，返回值的英文变量名
            think: 在此写入必要的上下文信息，以方便后续操作，如：打开了文档 A，其文档对象被命名为 word_object
      ###

      ### 注意事项 ###
      在命名返回值变量时，请遵循以下规则：
      1. 使用小写字母和下划线。
      2. 变量名应尽可能反映文档的内容或任务的上下文。
      3. 如果任务涉及特定的文件名或文档内容，请在变量名中包含这些信息。
      4. 请根据任务的具体场景灵活调整命名规则。
      ###

# agent 使用的工具
tools:
  - type: "VDB"
    name: "VDB1"

# agent 需要的输入结构
input_format: "format"

# agent 的下游 agent
children:
  - input_content_agent

# 其他的一些参数
ifLeaf: True
ifService: False
ifKnowledgeable: True
ifLearnable: False
runtimeRevisionNumber: 1
historyNumber: 0
energy: 0

